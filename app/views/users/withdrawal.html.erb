<!DOCTYPE html>
<html lang="en">
<%# <%= javascript_include_tag :defaults %>

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>MagisCoin - Admin</title>


  <!-- Custom fonts for this theme -->
  <link href="../../stylesheets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

  <!-- Theme CSS -->
  <link href="../../stylesheets/css/freelancer.min.css" rel="stylesheet">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script type="text/javascript" src="instascan.min.js"></script>

</head>

<body id="page-top">
<div class="container">
	<div class="row">
		<div class="col-md-offset-2 col-md-8 col-lg-offset-3 col-lg-6">
          <div class="col-sm-12">
              <h2>Withdraw from your Account</h2>
              <div class="col-xs-12 col-sm-8">
                  <%= form_tag('/users/withdraw')%>
                  <div class="field">
                    <div class="field">
                      <h4>Input desired amount to be withdrawn:</h4>
                      <h3><strong>PHP </strong></h3><%= text_field_tag (:balance)%>
                    </div>
                    <div>
                      <h4>Scan your QR</h4>
                      <video id="preview"></video>
                    </div>

                    <h4>QR content shown:</h4>
                    <%= text_field_tag (:id) %>
                    <%= text_field_tag (:name), nil, placeholder: "Hover to see name"%>
                  </div>

                  <div class="actions">
                      <%= submit_tag "Withdraw from User", data:{:confirm => 'Are you sure to withdraw from this account?'}, class: "btn btn-primary btn-block" %>
                      <%= link_to ' Go Back', users_path, :class => "btn btn-secondary btn-block", :style => "color:white;" %>
                  </div>
                  </form>
              </div>
         </div>
		</div>
	</div>
</div>
</body>
</html>
<script type="text/javascript">
    var scanner = new Instascan.Scanner({ video: document.getElementById('preview') });
    let result = scanner.scan();
    scanner.addListener('scan', function(content) {
         alert('Is your account number, ' + content + "?");
         document.getElementById("id").value = content;
         scanner.stop();
     });

    Instascan.Camera.getCameras().then(function (cameras) {
      if (cameras.length > 0) {
        scanner.start(cameras[0]);
      }
  });
  
  $("#id").hover(function(){
    $.getJSON("getname/" + document.getElementById("id").value + ".json", function( data ){
      document.getElementById("name").value = data.f_name + " " + data.l_name;
      document.getElementById("name").disabled = true;
    });
  });
</script>
